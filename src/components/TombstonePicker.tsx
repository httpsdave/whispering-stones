import React from 'react';
import type { TombstoneStyle } from '@/types';

interface TombstonePickerProps {
  selected: TombstoneStyle;
  onSelect: (style: TombstoneStyle) => void;
}

// Simplified 8x8 pixel previews for picker
const PREVIEW_DESIGNS: Record<number, string[][]> = {
  // Style 1: Classic rounded
  1: [
    ['_','_','0','0','0','0','_','_'],
    ['_','0','1','1','1','1','0','_'],
    ['_','0','1','2','2','1','0','_'],
    ['_','0','1','2','2','1','0','_'],
    ['_','0','1','2','2','3','0','_'],
    ['_','0','3','3','3','3','0','_'],
    ['0','4','4','4','4','4','4','0'],
    ['5','5','5','5','5','5','5','5'],
  ],
  // Style 2: Simple cross
  2: [
    ['_','_','_','0','0','_','_','_'],
    ['_','_','_','1','2','_','_','_'],
    ['_','0','1','1','2','2','0','_'],
    ['_','0','3','1','2','3','0','_'],
    ['_','_','_','1','2','_','_','_'],
    ['_','_','_','1','3','_','_','_'],
    ['_','_','0','4','4','0','_','_'],
    ['_','_','5','5','5','5','_','_'],
  ],
  // Style 3: Gothic arch
  3: [
    ['_','_','_','0','0','_','_','_'],
    ['_','_','0','1','1','0','_','_'],
    ['_','0','1','2','2','1','0','_'],
    ['_','0','1','2','2','1','0','_'],
    ['_','0','1','2','2','3','0','_'],
    ['_','0','3','3','3','3','0','_'],
    ['0','4','4','4','4','4','4','0'],
    ['5','5','5','5','5','5','5','5'],
  ],
  // Style 4: Obelisk monument
  4: [
    ['_','_','_','0','0','_','_','_'],
    ['_','_','0','1','1','0','_','_'],
    ['_','0','1','2','2','1','0','_'],
    ['_','0','1','2','2','1','0','_'],
    ['_','0','1','2','2','3','0','_'],
    ['0','4','4','4','4','4','4','0'],
    ['0','1','2','2','2','3','3','0'],
    ['5','5','5','5','5','5','5','5'],
  ],
  // Style 5: Gothic pointed
  5: [
    ['_','_','_','0','0','_','_','_'],
    ['_','_','0','1','1','0','_','_'],
    ['_','0','1','1','1','1','0','_'],
    ['0','1','1','2','2','1','1','0'],
    ['0','1','2','2','2','2','1','0'],
    ['0','1','2','2','2','3','3','0'],
    ['0','4','4','4','4','4','4','0'],
    ['5','5','5','5','5','5','5','5'],
  ],
  // Style 6: Rectangle clean
  6: [
    ['0','0','0','0','0','0','0','0'],
    ['0','1','1','1','1','1','1','0'],
    ['0','1','2','2','2','2','1','0'],
    ['0','1','2','2','2','2','1','0'],
    ['0','1','2','2','2','3','3','0'],
    ['0','3','3','3','3','3','3','0'],
    ['0','4','4','4','4','4','4','0'],
    ['5','5','5','5','5','5','5','5'],
  ],
  // Style 7: Weathered mossy
  7: [
    ['_','_','M','m','m','M','_','_'],
    ['_','M','m','1','1','m','M','_'],
    ['_','0','1','2','2','1','0','_'],
    ['_','0','1','2','2','1','0','_'],
    ['_','m','M','2','2','M','m','_'],
    ['_','M','m','M','m','M','m','_'],
    ['0','4','m','M','M','m','4','0'],
    ['5','5','5','5','5','5','5','5'],
  ],
  // Style 8: Celtic cross
  8: [
    ['_','_','_','0','0','_','_','_'],
    ['_','_','0','1','2','0','_','_'],
    ['_','0','1','1','2','2','0','_'],
    ['0','1','2','_','_','2','1','0'],
    ['0','3','1','1','2','1','3','0'],
    ['_','_','_','1','2','_','_','_'],
    ['_','_','0','4','4','0','_','_'],
    ['_','_','5','5','5','5','_','_'],
  ],
};

const COLORS: Record<string, string> = {
  '_': 'transparent',
  '0': '#9ca3af',
  '1': '#6b7280',
  '2': '#4b5563',
  '3': '#374151',
  '4': '#1f2937',
  '5': '#111827',
  'm': '#4a5d4a',
  'M': '#5c7a5c',
};

export default function TombstonePicker({ selected, onSelect }: TombstonePickerProps) {
  const styles: TombstoneStyle[] = [1, 2, 3, 4, 5, 6, 7, 8];
  
  const renderPreview = (style: TombstoneStyle) => {
    const design = PREVIEW_DESIGNS[style];
    const pixelSize = 100 / 8;
    
    return (
      <div className="w-full h-full relative" style={{ imageRendering: 'pixelated' }}>
        {design.map((row, y) => 
          row.map((pixel, x) => {
            if (pixel === '_') return null;
            return (
              <div
                key={`${x}-${y}`}
                className="absolute"
                style={{
                  left: `${x * pixelSize}%`,
                  top: `${y * pixelSize}%`,
                  width: `${pixelSize + 1}%`,
                  height: `${pixelSize + 1}%`,
                  backgroundColor: COLORS[pixel] || 'transparent',
                }}
              />
            );
          })
        )}
      </div>
    );
  };

  return (
    <div className="grid grid-cols-4 gap-2 md:gap-4">
      {styles.map((style) => (
        <button
          key={style}
          onClick={() => onSelect(style)}
          className={`w-12 h-16 md:w-16 md:h-20 transition-all ${
            selected === style 
              ? 'ring-2 ring-purple-500 scale-110' 
              : 'hover:scale-105 opacity-70 hover:opacity-100'
          }`}
          style={{ imageRendering: 'pixelated' }}
        >
          {renderPreview(style)}
        </button>
      ))}
    </div>
  );
}
